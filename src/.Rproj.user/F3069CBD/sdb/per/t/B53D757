{
    "collab_server" : "",
    "contents" : "#\n# explore the bom 1 minute solar data\n#\nsource(\"normd.R\")\n\nlibrary(stats4)\n\n#bom 1 minute data \n\nall_files <- list.files(path=\"../bom_1_min\")\nsolar_files <- all_files[which(startsWith(all_files,\"sl_\"))]\n\nfor (solar_file in solar_files)\n{\n  fn <- paste0(\"../bom_1_min/\",solar_file)\n  d <- read.csv(fn,header=FALSE,skip=1)\n  sd <- d[c(1:7,13)]\n  sd$mins_since_00 <- sd[,6]*60 + sd[,7]\n  colnames(sd) <- c(\"ID\",\"station number\",\"year\",\"month\",\"day\",\"hour\",\"min\",\"direct_irradiance\",\"mins_since_00\")\n  sd <- sd[,c(1,2,3,4,5,6,7,9,8)]\n  \n  # 5 minute samples\n  \n  sd5 <- subset(sd,(sd$mins_since_00 %% 5) == 0)\n  sd5 <- sd5[,c(6,9)]\n  hour_stats <- lapply(unique(sd5$hour), function(x) (subset(sd5, sd5$hour == x))$direct_irradiance)\n  hour_stats <- lapply(hour_stats, function(x) lapply(x, function(x) x[!is.na(x)]))\n  \n  # normalise maximum solar power to correspond to 3.0MW output (1:1 with wind generator)\n  \n  pmult <- 3.0/1000\n  \n  # 7am to 10pm densities\n  \n  hrs = seq(7,22)\n  solar_densities = list() \n  \n  for (hr in hrs) {\n    \n    pdata <- unlist(hour_stats[hr])\n    pdata <- pdata*pmult\n    solar_density <- density(pdata,from=0,to=7.5)\n    plot(solar_density,main=toString(hr))\n    \n    # density file has hour tag ..\n    \n    #dname <- paste(\"solar_density_\",toString(hr),sep=\"\")\n    #save(solar_density,file=paste(\"../rdata/\",dname,\".rd\",sep=\"\"))\n    solar_densities[[hr]] <- normd(solar_density)\n    \n    # print(hr)\n    # print(mean(solar_densities[[hr]]))\n    \n  }\n  \n  desc <- sub('\\\\..*', '', solar_file)\n  fname = paste0(desc,\"_solar_densities.rd\")\n  save(solar_densities,file=paste0(\"../rdata/\",fname))\n\n}\n",
    "created" : 1497928725529.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4218738965",
    "id" : "B53D757",
    "lastKnownWriteTime" : 1496985759,
    "last_content_update" : 1496985759,
    "path" : "~/renewable_spot_market/src/create_solar_densities.R",
    "project_path" : "create_solar_densities.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}